{% extends "index.html" %}

{% block title %}Responder PQRS{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-7" data-aos="fade-up">
            <div class="premium-card p-4 p-lg-5 border-0 shadow-lg">
                <div class="text-center mb-5">
                    <div class="mb-4 d-inline-flex align-items-center justify-content-center bg-light rounded-circle"
                        style="width: 80px; height: 80px;">
                        <i class="bi bi-mailbox text-dark fs-1"></i>
                    </div>
                    <h1 class="h4 fw-bold text-dark">Gestión de PQRS</h1>
                    <p class="text-muted small fw-medium">
                        Revisa el detalle de la solicitud y actualiza su estado.
                    </p>
                </div>

                <div class="mb-4 p-3 rounded-4 bg-light border border-dark border-opacity-5">
                    <p class="mb-1 extra-small text-muted text-uppercase fw-bold tracking-wider">Cliente</p>
                    <p class="mb-0 fw-bold">
                        {{ pq.client.get_full_name|default:pq.client.email }}
                    </p>
                </div>

                <form method="post">
                    {% csrf_token %}
                    <div class="row g-4">
                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-dark text-uppercase tracking-wider">
                                Tipo de solicitud
                            </label>
                            <select name="type" required>
                                <option value="P" {% if form.type == 'P' %}selected{% endif %}>Petición</option>
                                <option value="Q" {% if form.type == 'Q' %}selected{% endif %}>Queja</option>
                                <option value="R" {% if form.type == 'R' %}selected{% endif %}>Reclamo</option>
                                <option value="S" {% if form.type == 'S' %}selected{% endif %}>Sugerencia</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-dark text-uppercase tracking-wider">
                                Estado
                            </label>
                            <select name="status" required>
                                <option value="OPEN" {% if form.status == 'OPEN' %}selected{% endif %}>Abierto</option>
                                <option value="CLOSED" {% if form.status == 'CLOSED' %}selected{% endif %}>Cerrado</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <label class="form-label small fw-bold text-dark text-uppercase tracking-wider">
                                Descripción detallada (Solo lectura)
                            </label>
                            <textarea name="message" rows="5" readonly class="bg-light">{{ form.message }}</textarea>
                        </div>
                        <div class="col-12">
                            <label class="form-label small fw-bold text-dark text-uppercase tracking-wider">
                                Respuesta del Administrador
                            </label>
                            <textarea name="response" rows="5" placeholder="Escribe aquí tu respuesta para el cliente...">{{ form.response|default_if_none:'' }}</textarea>
                            <p class="text-muted extra-small mt-2">
                                <i class="bi bi-info-circle me-1"></i> 
                                Al guardar, el cliente recibirá una notificación por correo con tu respuesta.
                            </p>
                        </div>
                    </div>
                    <div class="d-grid mt-5 gap-3">
                        <button type="submit" class="btn btn-accent py-3 fw-bold">
                            Guardar cambios
                        </button>
                        <a href="{% url 'admin_pqrs_list' %}"
                            class="btn btn-outline-dark py-3 fw-bold rounded-4">
                            <i class="bi bi-arrow-left me-1"></i> Volver al listado
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

